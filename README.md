# SenNetSingleCellRNAseqDemo

This repository demonstrates a single-cell RNA-seq (scRNA-seq) pipeline applied to the SenNet dataset. The pipeline processes raw scRNA-seq datasets (downloaded scRNA-seq data should be put in the `data` folder) through a seven-step workflow to compare different methods of measuring transcriptional noise.

#### Pipeline Steps:
*   Step 1: Cleaning
*   Step 2: Integration
*   Step 3: Clustering
*   Step 4: Cell Type Identification
*   Step 5: Calculate Scallop
*   Step 6: Calculate Global Coordination Level (GCL) 
*   Step 7: Visualization

### Steps 1-5

Steps 1-5 can be found in the `ProcessingAndScallop.R` file.

*   Steps 1â€“4 are performed using Seurat for data cleaning, integration, clustering, and cell type identification.
*   Step 5 calculates Scallop scores for each cluster using `Scallop_Runner.py`.

These steps can be executed via command line by:
```bash
Rscript ProcessingAndScallop.R
```
or by sequentially executing each line within an R terminal or RStudio

### Step 6
GCL calculations can be computationally demanding, so overall analysis has been split into smaller chunks to be run on a high performance computer. The provided scripts use SLURM as the job scheduler, this may need to be replaced if your high performance computer uses a different job scheduler. In brief `Scheduler.sh` loads in the cleaned dataset generated by `ProcessingAndScallop.R`, and segments it into cluster specific files. It then will calculate the GCL of a given cell type using the `GCLRunner.R` file which is submited to a high performance cimputer using SLURM via the SubGCL.sh file. This can be executed by running
```bash
./Scheduler.Sh
```
### Step 7 Visualizaion

Outputs from Steps 5 and 6 can be collected and visualized using the `SenNEtGrapher.R` file which can be executed via command line by:
```bash
Rscript SenNEtGrapher.R
```
or by sequentially executing each line within an R terminal or RStudio